<!-- header -->
{% extends 'base.html' %}
{%- block title -%} Управление подсетями {%- endblock -%}

<!-- menu -->
<!-- уже установлено активным по умолчанию -->

<!-- основное содержимое -->

<!-- форма слева -->
{% block content_form %}
                                           {# ф-ия которая отвечает за рендер шаблона #}
<form class="form-control config" action="{{ url_for('index') }}" method="POST" autocomplete="on">
	<fieldset>
		<legend>Настройки конфига подсети</legend>
		<small>* если в списке не отображаются нужный vlan, то необходимо его создать на всех серверах</small>
{#
		<div class="form-group">
			<label for="choose_interface">Выберите интерфейс:</label>
			<select id="choose_interface" class="form-control" name="choose_interface" required>
				<option value="">---</option>
				<option value="203">203</option>
			</select>
		</div>

		<div class="form-group">
			<label for="subnet">Адрес подсети:</label>
			<input class="form-control" type="text" id="subnet" name="subnet" maxlength="15" pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" required size="15" placeholder="адрес подсети">
		</div>

		<div class="form-group">
			<label for="netmask">Маска подсети:</label>
			<input class="form-control" type="text" id="netmask" name="netmask" maxlength="15" pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" required size="15" placeholder="маска подсети">
		</div>

		<div class="form-group">
			<label for="gw">Шлюз по умолчанию:</label>
			<input class="form-control" type="text" id="gw" name="gw" maxlength="15" pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" required size="15" placeholder="шлюз по умолчанию">
		</div>

		<div class="form-group">
			<label for="broadcast">Укажите broadcast:</label>
			<input class="form-control" type="text" id="broadcast" name="broadcast" maxlength="15" pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" required size="15" placeholder="широковещательный адрес">
		</div>

		<div class="form-group">
			<label for="ip_start">Начальный адрес:</label>
			<input class="form-control" type="text" id="ip_start" name="ip_start" maxlength="15" pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" required size="15" placeholder="начальный адрес диапазона">
		</div>

		<div class="form-group">
			<label for="ip_end">Конечный адрес:</label>
			<input class="form-control" type="text" id="ip_end" name="ip_end" maxlength="15" pattern="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}" required size="15" placeholder="конечный адрес диапазона">
		</div>

		<div class="form-group">
			<label for="failover_peer">Failover peer:</label>
			<input class="form-control" type="text" id="failover_peer" name="failover_peer" required size="30" value="nr-dhcpd-failover">
		</div>

		<div class="form-group">
			<label for="opt_242">опция 242:</label>
			<small>* укажите параметр L2QVLAN</small>
			<input class="form-control" type="text" id="opt_242" name="opt_242" required size="150" value="MCIPADD=10.16.233.30,MCPORT=1719,TLSSRVR=10.16.233.23,HTTPSRVR=10.16.233.23,L2Q=1,L2QVLAN=XXX,VLANTEST=0">
		</div>
#}
     {# переменная form из view.py #}
     {% for field in form %}
        <div class="form-group">
           {{ field.label(class='control-label') }}
           {{ field(class='form-control') }}
        </div>     
     {% endfor %}
     
		<div class="form-group">
			<button type="submit" class="btn btn-primary btn-block" name="net_add">Сконфигурировать подсеть</button>
		</div>
	</fieldset>
</form>
{% endblock %}

<!-- таблица результатов -->
{% block table_result %}
<p>Сконфигурированные подсети и vlan</p>
<table class="table table-responsive" id="subnets_content">		
    <thead class="text-nowrap">		
        <tr>			
            <th>Интерфейс</th>
    			 <th>Ip подсети</th>
    		    <th>Маска подсети</th>
    			 <th>Шлюз подсети</th>
    			 <th>Broadcast</th>
    			 <th>Начальный ip</th>
    			 <th>Конечный ip</th>
    			 <th>Failover peer</th>
    			 <th>Опция 242</th>
    			 <th>Действия</th>
        </tr>
    </thead>
    <tbody>			
    <tr>
        {% for item in items %}
            <tr>
                <td>{{ item.interface }}</td>
                <td>{{ item.subnet_ipv4 }}</td>
                <td>{{ item.netmask }}</td>
                <td>{{ item.default_gw }}</td>
                <td>{{ item.broadcast }}</td>
                <td>{{ item.ip_range_start }}</td>
                <td>{{ item.ip_range_end }}</td>
                <td>{{ item.failover_peer }}</td>
                <td>{{ item.opt_242 }}</td>                
                <td>
            			<a href="#" class="action__icon btn" title="редактировать">
            				<img src="static/img/glyphicons-31-pencil.png" alt="редактировать">
            			</a>

            			<a href="#" class="action__icon btn" data-toggle="modal" \
                			data-target="remove__subnet" title="удалить" \
                			row-id="4" onclick=show_modal_delete(this);>
            				<img src="static/img/glyphicons-17-bin.png" alt="удалить">
            			</a>
            		</td>
            </tr>
        {% endfor %}
    </tr>
    </tbody>										
</table>
{% endblock %}

<!-- всплывающее окно -->
{% block popup_window %}
<div id="remove__subnet" class="modal remove__subnet" tabindex="-1">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Удаление подсети</h4>
				<button type="button" class="close" onclick="close_modal_delete();">×</button>
			</div>

			<div class="modal-body">Удалить подсеть ?</div>
			
			<div class="modal-footer">			
				<button type="button" class="btn btn-default" onclick="remove_row();">Да</button>		
				<button type="button" class="btn btn-danger" onclick="close_modal_delete();">Нет</button>						
			</div>
		</div>
	</div>
</div>

<div class="progress__spin"></div>
{% endblock %}



